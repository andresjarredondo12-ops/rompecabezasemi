<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Rompecabezas Frozen</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(#b3e5ff, #ffffff);
    overflow: hidden;
}

/* PANTALLA INICIO */
#startScreen {
    position: fixed;
    inset: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

#startScreen input {
    padding: 12px;
    font-size: 18px;
    margin-top: 10px;
}

#startScreen button {
    margin-top: 15px;
    padding: 12px 25px;
    font-size: 18px;
    cursor: pointer;
}

/* JUEGO */
#game {
    display: none;
    padding: 10px;
}

#topBar {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

#puzzleContainer {
    position: relative;
    width: 300px;
    height: 300px;
    margin: 20px auto;
    border: 3px solid #2196f3;
    background-size: cover;
}

.piece {
    position: absolute;
    width: 100px;
    height: 100px;
    background-size: 300px 300px;
    cursor: grab;
    border: 1px solid #fff;
}

/* GANASTE */
#winScreen {
    position: fixed;
    inset: 0;
    background: rgba(255,255,255,0.95);
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 10;
}

#winScreen h1 {
    font-size: 32px;
    color: #e91e63;
}

/* CONFETI */
.fall {
    position: fixed;
    top: -20px;
    font-size: 24px;
    animation: fall 4s linear infinite;
}

@keyframes fall {
    to {
        transform: translateY(110vh);
    }
}
</style>
</head>

<body>

<!-- INICIO -->
<div id="startScreen">
    <h1>ðŸ§© Rompecabezas Frozen</h1>
    <input type="text" id="usernameInput" placeholder="Tu nombre">
    <button onclick="startGame()">Jugar</button>
</div>

<!-- JUEGO -->
<div id="game">
    <div id="topBar">
        <div>Jugador: <b id="playerName"></b></div>
        <div>Nivel: <b id="level">1</b></div>
    </div>

    <div id="puzzleContainer"></div>
</div>

<!-- GANASTE -->
<div id="winScreen">
    <h1 id="winText"></h1>
    <button onclick="nextLevel()">Siguiente nivel</button>
</div>

<script>
/* === CONFIG === */
const images = [
    "https://i.imgur.com/7qV9FZL.jpg", // Elsa
    "https://i.imgur.com/Z9xJ0cM.jpg", // Anna
    "https://i.imgur.com/3rZ3K0n.jpg", // Olaf
    "https://i.imgur.com/qYF1X8U.jpg", // Elsa 2
    "https://i.imgur.com/VN0M6hM.jpg"  // Frozen grupo
];
// podÃ©s repetir / agregar hasta 200 imÃ¡genes

const size = 3;
let currentLevel = 0;
let pieces = [];
let username = "";

/* === INICIO === */
function startGame() {
    const input = document.getElementById("usernameInput");
    if (!input.value.trim()) return alert("IngresÃ¡ tu nombre");

    username = input.value.trim();
    localStorage.setItem("frozenUser", username);

    document.getElementById("playerName").textContent = username;
    document.getElementById("startScreen").style.display = "none";
    document.getElementById("game").style.display = "block";

    loadLevel();
}

/* === CARGA NIVEL === */
function loadLevel() {
    const container = document.getElementById("puzzleContainer");
    container.innerHTML = "";
    pieces = [];

    const img = images[currentLevel % images.length];
    container.style.backgroundImage = `url(${img})`;

    for (let y = 0; y < size; y++) {
        for (let x = 0; x < size; x++) {
            const piece = document.createElement("div");
            piece.className = "piece";
            piece.style.backgroundImage = `url(${img})`;
            piece.style.backgroundPosition = `-${x*100}px -${y*100}px`;
            piece.dataset.correctX = x * 100;
            piece.dataset.correctY = y * 100;

            piece.style.left = Math.random()*200 + "px";
            piece.style.top = Math.random()*200 + "px";

            enableDrag(piece);
            container.appendChild(piece);
            pieces.push(piece);
        }
    }

    document.getElementById("level").textContent = currentLevel + 1;
}

/* === DRAG === */
function enableDrag(el) {
    let offsetX, offsetY;

    el.onmousedown = e => {
        offsetX = e.offsetX;
        offsetY = e.offsetY;

        document.onmousemove = ev => {
            el.style.left = (ev.pageX - puzzleContainer.offsetLeft - offsetX) + "px";
            el.style.top  = (ev.pageY - puzzleContainer.offsetTop - offsetY) + "px";
        };

        document.onmouseup = () => {
            document.onmousemove = null;
            document.onmouseup = null;
            checkWin();
        };
    };
}

/* === CHECK === */
function checkWin() {
    let ok = true;
    pieces.forEach(p => {
        if (
            Math.abs(parseInt(p.style.left) - p.dataset.correctX) > 10 ||
            Math.abs(parseInt(p.style.top) - p.dataset.correctY) > 10
        ) ok = false;
    });

    if (ok) showWin();
}

/* === GANASTE === */
function showWin() {
    document.getElementById("winText").textContent =
        `ðŸŽ‰ Felicidades ${username}, ganaste!!! ðŸŽ‰`;
    document.getElementById("winScreen").style.display = "flex";
    startConfetti();
}

function nextLevel() {
    document.getElementById("winScreen").style.display = "none";
    currentLevel++;
    loadLevel();
}

/* === CONFETI === */
function startConfetti() {
    for (let i = 0; i < 40; i++) {
        const el = document.createElement("div");
        el.className = "fall";
        el.style.left = Math.random()*100 + "vw";
        el.style.animationDuration = (2 + Math.random()*3) + "s";
        el.textContent = ["ðŸ’–","â¤ï¸","â­"][Math.floor(Math.random()*3)];
        document.body.appendChild(el);

        setTimeout(() => el.remove(), 5000);
    }
}

/* === AUTO USER === */
window.onload = () => {
    const saved = localStorage.getItem("frozenUser");
    if (saved) document.getElementById("usernameInput").value = saved;
};
</script>

</body>
</html>







