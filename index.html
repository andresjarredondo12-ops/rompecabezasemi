<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Rompecabezas de Animales</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:linear-gradient(#b3e5ff,#ffffff);
    overflow:hidden;
}

/* PANTALLA INICIO */
#startScreen{
    position:fixed;
    inset:0;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
}

#startScreen input{
    padding:12px;
    font-size:18px;
    margin-top:10px;
}

#startScreen button{
    margin-top:15px;
    padding:12px 25px;
    font-size:18px;
    cursor:pointer;
}

/* JUEGO */
#game{
    display:none;
    padding:10px;
}

#topBar{
    display:flex;
    justify-content:space-between;
    font-size:18px;
}

#puzzleContainer{
    position:relative;
    width:300px;
    height:300px;
    margin:20px auto;
    border:4px solid #2196f3;
    background-size:cover;
    background-position:center;
}

.piece{
    position:absolute;
    width:100px;
    height:100px;
    background-size:300px 300px;
    cursor:grab;
    border:1px solid #fff;
}

/* GANASTE */
#winScreen{
    position:fixed;
    inset:0;
    background:linear-gradient(#0d47a1,#42a5f5);
    display:none;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    z-index:10;
    color:white;
    text-align:center;
}

#winScreen h1{
    font-size:32px;
    margin-bottom:20px;
}

#winScreen button{
    padding:14px 30px;
    font-size:18px;
    cursor:pointer;
    border:none;
    background:white;
    color:#0d47a1;
    border-radius:6px;
}

/* CONFETI */
.fall{
    position:fixed;
    top:-20px;
    font-size:26px;
    animation:fall linear forwards;
}

@keyframes fall{
    to{ transform:translateY(110vh); }
}
</style>
</head>

<body>

<!-- INICIO -->
<div id="startScreen">
    <h1>üß© Rompecabezas de Animales üê∂üê±</h1>
    <input type="text" id="usernameInput" placeholder="Tu nombre">
    <button onclick="startGame()">Jugar</button>
</div>

<!-- JUEGO -->
<div id="game">
    <div id="topBar">
        <div>Jugador: <b id="playerName"></b></div>
        <div>Nivel: <b id="level"></b> / 200</div>
    </div>
    <div id="puzzleContainer"></div>
</div>

<!-- GANASTE -->
<div id="winScreen">
    <h1 id="winText"></h1>
    <button onclick="nextLevel()">Pr√≥xima partida</button>
</div>

<script>
/* ================= IM√ÅGENES DE ANIMALES ================= */
// Im√°genes p√∫blicas y estables
const baseImages=[
    "https://images.unsplash.com/photo-1518717758536-85ae29035b6d", // perro
    "https://images.unsplash.com/photo-1518791841217-8f162f1e1131", // gato
    "https://images.unsplash.com/photo-1501706362039-c6e80948a59a", // le√≥n
    "https://images.unsplash.com/photo-1500530855697-b586d89ba3ee", // elefante
    "https://images.unsplash.com/photo-1504208434309-cb69f4fe52b0"  // caballo
];

// Generamos 200 niveles
const images=[];
for(let i=0;i<200;i++){
    images.push(baseImages[i % baseImages.length]);
}

const size=3;
let currentLevel=0;
let pieces=[];
let username="";

/* ================= INICIO ================= */
function startGame(){
    const input=document.getElementById("usernameInput");
    if(!input.value.trim()){
        alert("Ingres√° tu nombre");
        return;
    }

    username=input.value.trim();
    document.getElementById("playerName").textContent=username;

    const savedLevel=localStorage.getItem("animal_level_"+username);
    if(savedLevel) currentLevel=parseInt(savedLevel);

    document.getElementById("startScreen").style.display="none";
    document.getElementById("game").style.display="block";

    loadLevel();
}

/* ================= NIVEL ================= */
function loadLevel(){
    const container=document.getElementById("puzzleContainer");
    container.innerHTML="";
    pieces=[];

    const img=images[currentLevel];
    container.style.backgroundImage=`url(${img})`;

    for(let y=0;y<size;y++){
        for(let x=0;x<size;x++){
            const piece=document.createElement("div");
            piece.className="piece";
            piece.style.backgroundImage=`url(${img})`;
            piece.style.backgroundPosition=`-${x*100}px -${y*100}px`;
            piece.dataset.correctX=x*100;
            piece.dataset.correctY=y*100;

            piece.style.left=Math.random()*200+"px";
            piece.style.top=Math.random()*200+"px";

            enableDrag(piece);
            container.appendChild(piece);
            pieces.push(piece);
        }
    }

    document.getElementById("level").textContent=currentLevel+1;
}

/* ================= DRAG ================= */
function enableDrag(el){
    let offsetX,offsetY;

    el.onmousedown=e=>{
        offsetX=e.offsetX;
        offsetY=e.offsetY;

        document.onmousemove=ev=>{
            el.style.left=(ev.pageX-puzzleContainer.offsetLeft-offsetX)+"px";
            el.style.top =(ev.pageY-puzzleContainer.offsetTop-offsetY)+"px";
        };

        document.onmouseup=()=>{
            document.onmousemove=null;
            document.onmouseup=null;
            checkWin();
        };
    };
}

/* ================= CHECK ================= */
function checkWin(){
    let ok=true;
    pieces.forEach(p=>{
        if(
            Math.abs(parseInt(p.style.left)-p.dataset.correctX)>10 ||
            Math.abs(parseInt(p.style.top)-p.dataset.correctY)>10
        ) ok=false;
    });

    if(ok) showWin();
}

/* ================= GANASTE ================= */
function showWin(){
    document.getElementById("winText").textContent=
        `üéâ FELICIDADES ${username} GANASTE !!!! üéâ`;

    document.getElementById("winScreen").style.display="flex";
    startConfetti();
}

/* ================= SIGUIENTE ================= */
function nextLevel(){
    document.getElementById("winScreen").style.display="none";
    currentLevel++;
    if(currentLevel>=200) currentLevel=0;
    localStorage.setItem("animal_level_"+username,currentLevel);
    loadLevel();
}

/* ================= CONFETI ================= */
function startConfetti(){
    for(let i=0;i<50;i++){
        const el=document.createElement("div");
        el.className="fall";
        el.style.left=Math.random()*100+"vw";
        el.style.animationDuration=(2+Math.random()*3)+"s";
        el.textContent=["üíñ","‚ù§Ô∏è","‚≠ê"][Math.floor(Math.random()*3)];
        document.body.appendChild(el);
        setTimeout(()=>el.remove(),5000);
    }
}
</script>

</body>
</html>












