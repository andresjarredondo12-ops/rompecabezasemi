<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Frozen Puzzle</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(#b3e5fc, #e1f5fe);
    text-align: center;
    overflow: hidden;
}

.hidden { display: none; }

input, button {
    padding: 10px;
    font-size: 16px;
    margin-top: 10px;
}

button {
    background: #0288d1;
    color: white;
    border: none;
    border-radius: 6px;
}

#board {
    position: relative;
    width: 300px;
    height: 300px;
    margin: 20px auto;
    border: 3px solid #0288d1;
    background: #e1f5fe;
}

.piece {
    position: absolute;
    cursor: grab;
    border: 1px solid #fff;
    background-repeat: no-repeat;
}

#winScreen {
    position: fixed;
    inset: 0;
    background: rgba(179,229,252,0.95);
    z-index: 999;
}

#winText {
    margin-top: 120px;
    font-size: 28px;
    color: #01579b;
}

/* LLUVIA */
.fall {
    position: fixed;
    top: -50px;
    animation: fall linear infinite;
}

@keyframes fall {
    to { transform: translateY(110vh); }
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login">
    <h1>‚ùÑÔ∏è Frozen Puzzle ‚ùÑÔ∏è</h1>
    <p>Ingres√° tu nombre</p>
    <input id="username">
    <br>
    <button onclick="startGame()">Jugar</button>
</div>

<!-- JUEGO -->
<div id="game" class="hidden">
    <h2 id="playerName"></h2>
    <div id="board"></div>
</div>

<!-- GANASTE -->
<div id="winScreen" class="hidden">
    <div id="winText"></div>
</div>

<script>
/* ================= CONFIG ================= */

const IMAGES = {
    elsa: "https://i.imgur.com/2z8F0T4.jpg",
    anna: "https://i.imgur.com/9QO8F0R.jpg",
    olaf: "https://i.imgur.com/rz7FQ0T.jpg"
};

const SIZE = 3;
const PIECE = 100;

/* ================= ESTADO ================= */

let user = "";
let correct = 0;

/* ================= LOGIN ================= */

function startGame() {
    user = document.getElementById("username").value.trim();
    if (!user) return alert("Ingres√° tu nombre");

    document.getElementById("login").classList.add("hidden");
    document.getElementById("game").classList.remove("hidden");
    document.getElementById("playerName").innerText = "Jugador: " + user;

    loadPuzzle();
}

/* ================= PUZZLE ================= */

function loadPuzzle() {
    const board = document.getElementById("board");
    board.innerHTML = "";
    correct = 0;

    const imgKeys = Object.keys(IMAGES);
    const img = IMAGES[imgKeys[Math.floor(Math.random() * imgKeys.length)]];

    let positions = [];

    for (let y = 0; y < SIZE; y++) {
        for (let x = 0; x < SIZE; x++) {
            positions.push({ x, y });
        }
    }

    positions.sort(() => Math.random() - 0.5);

    positions.forEach((pos, i) => {
        const piece = document.createElement("div");
        piece.className = "piece";
        piece.style.width = PIECE + "px";
        piece.style.height = PIECE + "px";

        const correctX = i % SIZE;
        const correctY = Math.floor(i / SIZE);

        piece.dataset.correctX = correctX;
        piece.dataset.correctY = correctY;

        piece.style.backgroundImage = `url(${img})`;
        piece.style.backgroundSize = `${SIZE * PIECE}px ${SIZE * PIECE}px`;
        piece.style.backgroundPosition = `-${correctX * PIECE}px -${correctY * PIECE}px`;

        piece.style.left = pos.x * PIECE + "px";
        piece.style.top = pos.y * PIECE + "px";

        drag(piece);
        board.appendChild(piece);
    });
}

/* ================= DRAG ================= */

function drag(el) {
    let offsetX, offsetY;

    el.onmousedown = e => {
        offsetX = e.offsetX;
        offsetY = e.offsetY;

        document.onmousemove = move;
        document.onmouseup = drop;
    };

    function move(e) {
        el.style.left = (e.pageX - offsetX - board.offsetLeft) + "px";
        el.style.top = (e.pageY - offsetY - board.offsetTop) + "px";
    }

    function drop() {
        document.onmousemove = null;
        document.onmouseup = null;

        const x = Math.round(el.offsetLeft / PIECE);
        const y = Math.round(el.offsetTop / PIECE);

        el.style.left = x * PIECE + "px";
        el.style.top = y * PIECE + "px";

        if (x == el.dataset.correctX && y == el.dataset.correctY) {
            el.onmousedown = null;
            correct++;
            if (correct === SIZE * SIZE) win();
        }
    }
}

/* ================= GANASTE ================= */

function win() {
    document.getElementById("winScreen").classList.remove("hidden");
    document.getElementById("winText").innerText =
        `üéâ Felicidades ${user}, ganaste!!!! üéâ`;

    for (let i = 0; i < 50; i++) rain();
}

function rain() {
    const el = document.createElement("div");
    const icons = ["‚ù§Ô∏è", "üíó", "‚≠ê"];
    el.innerText = icons[Math.floor(Math.random() * icons.length)];
    el.className = "fall";
    el.style.left = Math.random() * 100 + "vw";
    el.style.fontSize = 20 + Math.random() * 20 + "px";
    el.style.animationDuration = 2 + Math.random() * 3 + "s";
    document.body.appendChild(el);

    setTimeout(() => el.remove(), 5000);
}
</script>

</body>
</html>



